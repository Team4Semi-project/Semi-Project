<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title th:text="${member.memberNickname} + '님의 마이페이지'">
    LEMONA - 마이페이지
  </title>
  <link rel="stylesheet" th:href="@{/css/myPage/mypage.css}" />
  <link rel="stylesheet" th:href="@{/css/board/boardList.css}" />
  <!-- Material Symbols 아이콘 사용을 위한 링크 -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body>
  <!-- 헤더 프래그먼트 -->
  <header th:replace="~{common/header :: header}"></header>

  <div class="container">
    <!-- 프로필 섹션 -->
    <div class="my-profile-scope">
      <section class="profile-section">
        <div class="profile-header">
          <div class="profile-avatar">
            <img th:src="${member.profileImg != null ? member.profileImg : '/images/user.png'}" alt="프로필 이미지" />
          </div>
          <div class="profile-info">
            <div class="nickname-wrapper">
              <span class="profile-nickname" th:text="${member.memberNickname}">레몬짱</span>
              <a href="/mypage/editProfile" class="edit-icon">
                <span class="material-symbols-outlined">settings</span>
              </a>
            </div>
            <div class="profile-stats">
              <button class="stat-btn">
                내가 쓴 글
                <span class="stat-number" th:text="${writtenCount ?: 0}">0</span>
              </button>
              <button class="stat-btn">
                댓글 수
                <span class="stat-number" th:text="${commentCount ?: 0}">0</span>
              </button>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- 탭 섹션 -->
    <nav class="tabs">
      <!-- <a href="/mypage/userProfile" id="postsTab" class="tab active" th:text="|${member.memberNickname}님이 쓴 레시피|">내가 쓴
        레시피</a>
      <a href="/mypage/like" id="lemonaTab" class="tab" th:text="|${member.memberNickname}님이 쓴 게시글|">내가 쓴 게시글</a> -->
      <a href="#" id="recipeTab" class="tab active">내가 쓴 레시피</a>
      <a href="#" id="postTab" class="tab">내가 쓴 게시글</a>
    </nav>

    <!-- 내가 쓴 레시피 내용 -->
    <div id="recipeContent">
      <div class="recipe-container cozy-view" id="cozy">
        <div th:replace="~{board/cozyList :: cozyList}"></div>
      </div>

      <div class="recipe-container agenda-view" id="agenda" style="display: none">
        <div th:replace="~{board/agendaList :: agendaList}"></div>
      </div>
    </div>

    <!-- 내가 쓴 게시글 내용 -->
    <div id="postContent" style="display: none;">
      <div class="recipe-container cozy-view" id="cozy">
        <div th:replace="~{board/cozyList :: cozyList}"></div>
      </div>

      <div class="recipe-container agenda-view" id="agenda" style="display: none">
        <div th:replace="~{board/agendaList :: agendaList}"></div>
      </div>
    </div>


    <!-- 게시글 섹션 -->
    <!-- 게시글 컨테이너 (Cozy View) fragment -->

    <!-- 게시글 컨테이너 (Agenda View) fragment -->
    <!-- <div class="recipe-container agenda-view" id="agenda" style="display: none">
      <div th:replace="~{board/agendaList :: agendaList}"></div>
    </div> -->

    <!-- 페이지네이션 : 게시글이 있을 때만 페이지네이션이 보이게 할 예정 -->
    <div class="pagination-area">
      <!-- 일반 목록 조회 (검색 X )-->
      <ul class="pagination" th:unless="${param.key}" th:object="${pagination}">
        <!-- 첫 페이지로 이동 -->
        <li>
          <a th:href="@{/board/1/{categoryNo}(categoryNo=${categoryNo},cp=1)} + '&sort=' +  ${sort} ">&lt;&lt;</a>
        </li>
        <!-- << : /board/1?cp=1 -->

        <!-- 이전 목록 마지막 번호로 이동 -->
        <li>
          <a th:href="@{/board/1/{categoryNo}(categoryNo=${categoryNo},cp=*{prevPage})} + '&sort=' +  ${sort} ">&lt;</a>
        </li>
        <!-- < : /board/1?cp=10 -->

        <!-- 특정 페이지로 이동 -->
        <th:block th:each="i : *{#numbers.sequence(startPage, endPage)}">
          <!-- 현재 보고있는 페이지 -->
          <li th:if="${i} == *{currentPage}">
            <a class="current" th:text="${i}">현재페이지</a>
          </li>

          <!-- 보고있지 않은 페이지 -->
          <li th:unless="${i} == *{currentPage} or ${i} == 0">
            <a th:href="@{/board/1/{categoryNo}(categoryNo=${categoryNo},cp=${i})} + '&sort=' +  ${sort} "
              th:text="${i}">이동할 페이지</a>
          </li>
        </th:block>

        <!-- 다음 목록 시작 번호로 이동 -->
        <li>
          <a
            th:href="@{/board/1/{categoryNo}(categoryNo=${categoryNo}, cp=*{nextPage})} + '&sort=' +  ${sort} ">&gt;</a>
        </li>

        <!-- 끝 페이지로 이동 -->
        <li>
          <a
            th:href="@{/board/1/{categoryNo}(categoryNo=${categoryNo}, cp=*{maxPage})} + '&sort=' +  ${sort} ">&gt;&gt;</a>
        </li>
      </ul>
    </div>
  </div>

  <!-- 푸터 프래그먼트 -->
  <footer th:replace="~{common/footer :: footer}"></footer>

  <!-- 공통 스크립트 -->
  <script th:src="@{/js/board/boardList.js}"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const recipeTab = document.getElementById('recipeTab');
      const postTab = document.getElementById('postTab');
      const recipeContent = document.getElementById('recipeContent');
      const postContent = document.getElementById('postContent');

      recipeTab.addEventListener('click', function (e) {
        e.preventDefault(); // 페이지 이동 막기
        recipeTab.classList.add('active');
        postTab.classList.remove('active');
        recipeContent.style.display = 'block';
        postContent.style.display = 'none';
        location.href = '/mypage/userProfile?type=recipe';
      });

      postTab.addEventListener('click', function (e) {
        e.preventDefault(); // 페이지 이동 막기
        postTab.classList.add('active');
        recipeTab.classList.remove('active');
        postContent.style.display = 'block';
        recipeContent.style.display = 'none';
        location.href = '/mypage/userProfile?type=post';
      });
    });
  </script>


  <!-- <script>
    function showTab(tabName) {
      const tabs = document.querySelectorAll(".post-section");
      tabs.forEach((tab) => (tab.style.display = "none"));
      document.getElementById(tabName).style.display = "block";
      document
        .querySelectorAll(".tab-btn")
        .forEach((btn) => btn.classList.remove("active"));
      document
        .querySelector(`button[onclick="showTab('${tabName}')"]`)
        .classList.add("active");
      // 탭 전환 시 페이지 번호 초기화 (cp=1)
      window.location.href = "/myPage/mypage?cp=1&tab=" + tabName;
    }

    // 페이지 로드 시 현재 탭 설정
    document.addEventListener("DOMContentLoaded", function () {
      const currentTab = /*[[${param.tab ?: 'posts'}]]*/ "posts";
      const tabs = document.querySelectorAll(".post-section");
      tabs.forEach((tab) => (tab.style.display = "none"));
      document.getElementById(currentTab).style.display = "block";
      document.querySelectorAll(".tab-btn").forEach((btn) => {
        btn.classList.remove("active");
        if (btn.getAttribute("onclick").includes(currentTab)) {
          btn.classList.add("active");
        }
      });
    });
  </script> -->
</body>

</html>