<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title th:text="${session.loginMember.memberNickname} + 'ÎãòÏùò ÎßàÏù¥ÌéòÏù¥ÏßÄ'">
    LEMONA - ÎßàÏù¥ÌéòÏù¥ÏßÄ
  </title>
  <link rel="stylesheet" href="/css/mypage.css" />
  <!-- Material Symbols ÏïÑÏù¥ÏΩò ÏÇ¨Ïö©ÏùÑ ÏúÑÌïú ÎßÅÌÅ¨ -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body>
  <!-- Ìó§Îçî ÌîÑÎûòÍ∑∏Î®ºÌä∏ -->
  <header th:replace="~{common/header :: header}"></header>

  <div class="container">
    <!-- ÌîÑÎ°úÌïÑ ÏÑπÏÖò -->
    <section class="profile-section">
      <div class="profile-header">
        <div class="profile-avatar">
          <img
            th:src="${session.loginMember.profileImg != null ? session.loginMember.profileImg : '/images/lemona-default-avatar.png'}"
            alt="ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ" />
        </div>
        <div class="profile-info">
          <div class="nickname-wrapper">
            <span class="profile-nickname" th:text="${session.loginMember.memberNickname}">Î†àÎ™¨Ïß±</span>
            <a href="/mypage/editProfile" class="edit-icon">
              <span class="material-symbols-outlined">settings</span>
            </a>
          </div>
          <div class="profile-stats">
            <button class="stat-btn">
              ÎÇ¥Í∞Ä Ïì¥ Í∏Ä
              <span class="stat-number" th:text="${writtenCount ?: 0}">0</span>
            </button>
            <button class="stat-btn">
              ÎåìÍ∏Ä Ïàò
              <span class="stat-number" th:text="${commentCount ?: 0}">0</span>
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- ÌÉ≠ ÏÑπÏÖò -->
    <nav class="tabs">
      <a href="/mypage/main" id="postsTab" class="tab active">ÎÇ¥Í∞Ä Ïì¥ Í∏Ä</a>
      <a href="/mypage/like" id="lemonaTab" class="tab">ÎÇ¥ Î†àÎ™®ÎÇò</a>
    </nav>

    <!-- Í≤åÏãúÍ∏Ä ÏÑπÏÖò -->
    <section class="post-section" id="posts">
      <div class="recipe-grid">
        <article class="recipe-card" th:each="post : ${writtenPosts}">
          <div class="recipe-image">
            <img th:src="${post.imageUrl != null ? post.imageUrl : '/images/default-recipe.png'}" alt="Í≤åÏãúÍ∏Ä Ïù¥ÎØ∏ÏßÄ" />
          </div>
          <div class="recipe-content">
            <h3 class="recipe-title" th:text="${post.title}">Í≤åÏãúÎ¨º Ï†úÎ™©</h3>
            <div class="recipe-meta">
              <span class="recipe-date" th:text="${post.createDate}">2025-05-26</span>
            </div>
            <div class="recipe-stats">
              <div class="stat-item">
                <span class="icon">‚ù§Ô∏è</span>
                <span th:text="${post.likes}">0</span>
              </div>
              <div class="stat-item">
                <span class="icon">üëÅÔ∏è</span>
                <span th:text="${post.views}">0</span>
              </div>
            </div>
          </div>
        </article>
      </div>
      <div class="pagination-area" th:if="${not #lists.isEmpty(writtenPosts)}">
        <ul class="pagination" th:object="${writtenPagination}">
          <li><a th:href="@{/myPage/mypage(cp=1, tab='posts')}">
              <<< /a>
          </li>
          <li>
            <a th:href="@{/myPage/mypage(cp=*{prevPage}, tab='posts')}">
              << /a>
          </li>
          <th:block th:each="i : *{#numbers.sequence(startPage, endPage)}">
            <li th:if="${i} == *{currentPage}">
              <a class="current" th:text="${i}"></a>
            </li>
            <li th:unless="${i} == *{currentPage} or ${i} == 0">
              <a th:href="@{/myPage/mypage(cp=${i}, tab='posts')}" th:text="${i}"></a>
            </li>
          </th:block>
          <li>
            <a th:href="@{/myPage/mypage(cp=*{nextPage}, tab='posts')}">></a>
          </li>
          <li>
            <a th:href="@{/myPage/mypage(cp=*{maxPage}, tab='posts')}">>></a>
          </li>
        </ul>
      </div>
    </section>

    <section class="post-section" id="lemona" style="display: none">
      <div class="recipe-grid">
        <article class="recipe-card" th:each="lemona : ${likedPosts}">
          <div class="recipe-image">
            <img th:src="${lemona.imageUrl != null ? lemona.imageUrl : '/images/default-recipe.png'}" alt="Î†àÎ™®ÎÇò Ïù¥ÎØ∏ÏßÄ" />
          </div>
          <div class="recipe-content">
            <h3 class="recipe-title" th:text="${lemona.title}">
              Î†àÎ™®ÎÇò Ï†úÎ™©
            </h3>
            <div class="recipe-meta">
              <span class="recipe-date" th:text="${lemona.createDate}">2025-05-26</span>
            </div>
            <div class="recipe-stats">
              <div class="stat-item">
                <span class="icon">‚ù§Ô∏è</span>
                <span th:text="${lemona.likes}">0</span>
              </div>
              <div class="stat-item">
                <span class="icon">üëÅÔ∏è</span>
                <span th:text="${lemona.views}">0</span>
              </div>
            </div>
          </div>
        </article>
      </div>
      <div class="pagination-area" th:if="${not #lists.isEmpty(likedPosts)}">
        <ul class="pagination" th:object="${likedPagination}">
          <li><a th:href="@{/myPage/mypage(cp=1, tab='lemona')}">
              <<< /a>
          </li>
          <li>
            <a th:href="@{/myPage/mypage(cp=*{prevPage}, tab='lemona')}">
              << /a>
          </li>
          <th:block th:each="i : *{#numbers.sequence(startPage, endPage)}">
            <li th:if="${i} == *{currentPage}">
              <a class="current" th:text="${i}"></a>
            </li>
            <li th:unless="${i} == *{currentPage} or ${i} == 0">
              <a th:href="@{/myPage/mypage(cp=${i}, tab='lemona')}" th:text="${i}"></a>
            </li>
          </th:block>
          <li>
            <a th:href="@{/myPage/mypage(cp=*{nextPage}, tab='lemona')}">></a>
          </li>
          <li>
            <a th:href="@{/myPage/mypage(cp=*{maxPage}, tab='lemona')}">>></a>
          </li>
        </ul>
      </div>
    </section>
  </div>

  <!-- Ìë∏ÌÑ∞ ÌîÑÎûòÍ∑∏Î®ºÌä∏ -->
  <footer th:replace="~{common/footer :: footer}"></footer>

  <script>
    function showTab(tabName) {
      const tabs = document.querySelectorAll(".post-section");
      tabs.forEach((tab) => (tab.style.display = "none"));
      document.getElementById(tabName).style.display = "block";
      document
        .querySelectorAll(".tab-btn")
        .forEach((btn) => btn.classList.remove("active"));
      document
        .querySelector(`button[onclick="showTab('${tabName}')"]`)
        .classList.add("active");
      // ÌÉ≠ Ï†ÑÌôò Ïãú ÌéòÏù¥ÏßÄ Î≤àÌò∏ Ï¥àÍ∏∞Ìôî (cp=1)
      window.location.href = "/myPage/mypage?cp=1&tab=" + tabName;
    }

    // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÌòÑÏû¨ ÌÉ≠ ÏÑ§Ï†ï
    document.addEventListener("DOMContentLoaded", function () {
      const currentTab = /*[[${param.tab ?: 'posts'}]]*/ "posts";
      const tabs = document.querySelectorAll(".post-section");
      tabs.forEach((tab) => (tab.style.display = "none"));
      document.getElementById(currentTab).style.display = "block";
      document.querySelectorAll(".tab-btn").forEach((btn) => {
        btn.classList.remove("active");
        if (btn.getAttribute("onclick").includes(currentTab)) {
          btn.classList.add("active");
        }
      });
    });
  </script>
</body>

</html>